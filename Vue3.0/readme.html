<!DOCTYPE html>
<html>
<head>
<title>readme.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<blockquote>
<blockquote>
<p>`</p>
<blockquote>
<blockquote>
<blockquote>
<h2 id="%E5%85%B3%E4%BA%8Evue-30">å…³äºVue 3.0</h2>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h4 id="%E5%89%8D%E8%A8%80">å‰è¨€ï¼š</h4>
<ul>
<li>æ­£å¼ç‰ˆï¼š<code>Vue</code>å›¢é˜Ÿäº2020.09.18æ—¥å‘å¸ƒ3.0æ­£å¼ç‰ˆ</li>
<li>å‰ç½®æ¡ä»¶ï¼š<code>Vue</code>è™½ç„¶ä¿ç•™äº†å¤§é‡çš„2.0ç‰ˆæœ¬<code>api</code>,ä½†ç”±äºæ˜¯ä½¿ç”¨<code>TypeScript</code>é‡æ„ï¼Œæ‰€ä»¥æƒ³è¦å­¦ä¹ 3.0èµ·ç è¦æŒæ¡<code>TS</code>çš„åŸºç¡€ä½¿ç”¨</li>
</ul>
<p><strong>Vue3.0ä¸­çš„å…­å¤§äº®ç‚¹</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">åºå·</th>
<th style="text-align:left">ç‰¹æ€§</th>
<th style="text-align:left">è§£æ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left"><code>Performance </code></td>
<td style="text-align:left">æ€§èƒ½ä¸Šæ¯”Vue2.0å¿«1.3~2å€</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left"><code>Tree shaking support </code></td>
<td style="text-align:left">æŒ‰éœ€ç¼–è¯‘ï¼Œä½“ç§¯æ›´åŠ è½»é‡åŒ–</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left"><code>Composition API</code></td>
<td style="text-align:left">ç»„åˆAPIï¼Œå¯å‚è€ƒ<code>React hooks</code>ç†è§£</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left"><code>Better TypeScript support</code></td>
<td style="text-align:left">å¯¹ Ts æä¾›äº†æ›´å¥½çš„æ”¯æŒ</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left"><code>Custom Renderer API</code></td>
<td style="text-align:left">æš´éœ²äº†è‡ªå®šä¹‰æ¸²æŸ“API</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left"><code>Fragment,Teleport(Protal),Suspense</code></td>
<td style="text-align:left">æ›´å…ˆè¿›çš„ç»„ä»¶</td>
</tr>
</tbody>
</table>
<p>æ³¨ï¼šå…·ä½“å¯ä»¥å‚è€ƒ<code>github</code>ä¸­<code>Vue3.0</code>çš„ç›¸å…³æºæ–‡ä»¶<code>https://github.com/vuejs/vue-next/tree/master/packages</code></p>
<hr>
<h3 id="vue30%E6%98%AF%E5%9F%BA%E4%BA%8E%E4%BB%80%E4%B9%88%E4%BC%98%E5%8C%96%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E6%9B%B4%E8%BD%BB%E9%87%8F%E6%9B%B4%E5%BF%AB%E7%9A%84">Vue3.0æ˜¯åŸºäºä»€ä¹ˆä¼˜åŒ–ï¼Œå¦‚ä½•åšåˆ°æ›´è½»é‡ï¼Œæ›´å¿«çš„ï¼Ÿ</h3>
<ul>
<li>ä¸€ ã€diff ç®—æ³•ä¼˜åŒ–
<ul>
<li>Vue 2ä¸­çš„è™šæ‹ŸDomæ˜¯å…¨é‡æ¯”è¾ƒ</li>
<li>Vue 3æ–°å¢é™æ€æ ‡è®°ï¼ˆPatchFlagï¼‰</li>
<li>åœ¨ä¸æ•°æ®å˜åŒ–åï¼Œä¸ä¸Šæ¬¡è™šæ‹ŸDOMèŠ‚ç‚¹æ¯”è¾ƒæ—¶ï¼Œåªæ¯”è¾ƒå¸¦æœ‰PatchFlagæ ‡è®°çš„èŠ‚ç‚¹</li>
<li>å¹¶ä¸”å¯ä»¥ä»flagä¿¡æ¯ä¸­å¾—çŸ¥å…·ä½“éœ€è¦æ¯”è¾ƒçš„å†…å®¹ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>é™æ€æ ‡è®°å°±æ˜¯éå…¨é‡æ¯”è¾ƒï¼Œåªä¼šæ¯”è¾ƒé‚£äº›è¢«æ ‡è®°çš„å˜é‡ï¼Œæ¯”è¾ƒçš„æ•°é‡å¤§å¤§å‡å°‘å› æ­¤æå‡æ€§èƒ½</p>
<blockquote>
<p>è¿™è®©æˆ‘æƒ³åˆ°äº†JSåƒåœ¾å›æ”¶æœºåˆ¶é‡Œçš„æ ‡è®°æ¸…é™¤ï¼ŒORZ æ„Ÿè§‰ç†Ÿæ‚‰ï¼Œä½†å›æ”¶æœºæ˜¯å…¨æ ‡è®°åªæ˜¯æ¸…é™¤å…·æœ‰ç¦»å¼€ç¯å¢ƒçš„æ ‡è®°å˜é‡è€Œå·²ï¼‰</p>
<blockquote>
<p><strong>å†…å­˜åƒåœ¾å›æ”¶æœºåˆ¶åœ¨æˆ‘å»å¹´çš„åšæ–‡ä¸­ğŸ‘‰<a href="https://www.xipengheng.cn/?p=321">ç‚¹å‡»</a></strong>
æ¯”å¦‚ä¸‹é¢è¿™ä¸ªç¤ºä¾‹</p>
</blockquote>
</blockquote>
</blockquote>
<pre class="hljs"><code><div>    &lt;div&gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span>åœŸè±†å“‡~ <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é™æ€æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{msg}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
    &lt;<span class="hljs-regexp">/div&gt;
 /</span><span class="hljs-regexp">/------------åœ¨ä¸‹æ–¹ç¼–è¯‘ä¸­å¯ä»¥æ¸…æ™°çœ‹åˆ°æ ‡è®°--------------------
</span></div></code></pre>
<pre class="hljs"><code><div><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>{
  <span class="hljs-keyword">return</span> (_openBlock(), _createBlock(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, [
    _createVNode(<span class="hljs-string">"a"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">" åœŸè±†å“‡~ "</span>),
    _createVNode(<span class="hljs-string">"p"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"é™æ€æ–‡æœ¬"</span>),
    _createVNode(<span class="hljs-string">"p"</span>, <span class="hljs-literal">null</span>, _toDisplayString(_ctx.msg), <span class="hljs-number">1</span> <span class="hljs-comment">/* textæ–‡æœ¬åœ¨è¿™é‡Œæ ‡è®°ä¸º1 */</span>)
  ]))
}
<span class="hljs-comment">//ç¼–è¯‘ç½‘å€---&gt;  https://vue-next-template-explorer.netlify.app/</span>
</div></code></pre>
<ul>
<li>ç”±ä»¥ä¸Šå¯å¾—çŸ¥ï¼š
<ul>
<li>åœ¨vue2.0ä¸­å¯¹äºæ•°æ®å˜åŒ–åé‡æ–°æ¸²æŸ“çš„DOMæ ‘ï¼Œä¼šä¸ä¸Šæ¬¡æ¸²æŸ“çš„DOMæ ‘é€ä¸ªæ¯”è¾ƒèŠ‚ç‚¹</li>
<li>åœ¨vue3.0çš„diffä¸­ï¼Œåˆ›å»ºè™šæ‹ŸDOMæ—¶ï¼Œä¼šæ ¹æ®è¯¥DOMæ˜¯å¦ä¼šå˜åŒ–è€Œæ·»åŠ é™æ€æ ‡è®°ï¼Œæ•°æ®æ›´æ–°éœ€è¦ç”Ÿæˆæ–°çš„è™šæ‹ŸDOMæ—¶ï¼Œåªä¼šä¸ä¸Šæ¬¡æ¸²æŸ“çš„ä¸”è¢«æ ‡è®°çš„èŠ‚ç‚¹æ¯”è¾ƒã€‚</li>
<li>ä¸åŒçš„åŠ¨æ€å˜åŒ–ç±»å‹ï¼Œä¸ºäº†ä¾¿äºåŒºåˆ†ï¼Œæ ‡è®°çš„æ•°å€¼ä¹Ÿä¸åŒ</li>
<li>å› æ­¤åœ¨vue3.0ä¸­æ¯”è¾ƒæ¬¡æ•°æ›´å°‘ï¼Œæ•ˆç‡æ›´é«˜ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</li>
</ul>
</li>
</ul>
<h4 id="%E7%A4%BA%E4%BE%8B"><strong>ç¤ºä¾‹</strong></h4>
<pre class="hljs"><code><div><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>{
  <span class="hljs-keyword">return</span> (_openBlock(), _createBlock(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, [
    _createVNode(<span class="hljs-string">"a"</span>, { <span class="hljs-attr">id</span>: _ctx.Poo }, <span class="hljs-string">" åœŸè±†å“‡~ "</span>, <span class="hljs-number">8</span> <span class="hljs-comment">/* PROPS */</span>, [<span class="hljs-string">"id"</span>]),
    _createVNode(<span class="hljs-string">"p"</span>, { <span class="hljs-attr">class</span>: _ctx.style }, <span class="hljs-string">" é™æ€æ–‡æœ¬"</span>, <span class="hljs-number">2</span> <span class="hljs-comment">/* CLASS */</span>),
    _createVNode(<span class="hljs-string">"p"</span>, <span class="hljs-literal">null</span>, _toDisplayString(_ctx.msg), <span class="hljs-number">1</span> <span class="hljs-comment">/* TEXT */</span>)
  ]))
}
</div></code></pre>
<h4 id="%E6%A0%87%E8%AE%B0%E6%9F%A5%E8%AF%A2%E5%88%97%E8%A1%A8"><strong>æ ‡è®°æŸ¥è¯¢åˆ—è¡¨</strong></h4>
<pre class="hljs"><code><div>  TEXT = <span class="hljs-number">1</span>,<span class="hljs-comment">// --å–å€¼æ˜¯1---è¡¨ç¤ºå…·æœ‰åŠ¨æ€textContentçš„å…ƒç´ </span>
  CLASS = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">1</span>,  <span class="hljs-comment">// --å–å€¼æ˜¯2---è¡¨ç¤ºæœ‰åŠ¨æ€Classçš„å…ƒç´ </span>
  STYLE = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">2</span>,  <span class="hljs-comment">// --å–å€¼æ˜¯4---è¡¨ç¤ºåŠ¨æ€æ ·å¼ï¼ˆé™æ€å¦‚style="color: pink"ï¼Œä¹Ÿä¼šæå‡è‡³åŠ¨æ€ï¼‰</span>
  PROPS = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">3</span>,  <span class="hljs-comment">// --å–å€¼æ˜¯8--- è¡¨ç¤ºå…·æœ‰éç±»/æ ·å¼åŠ¨æ€é“å…·çš„å…ƒç´ ã€‚</span>
  FULL_PROPS = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>,  <span class="hljs-comment">// --å–å€¼æ˜¯16---è¡¨ç¤ºå¸¦æœ‰åŠ¨æ€é”®çš„é“å…·çš„å…ƒç´ ï¼Œä¸ä¸Šé¢ä¸‰ç§ç›¸æ–¥</span>
  HYDRATE_EVENTS = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">5</span>,  <span class="hljs-comment">// --å–å€¼æ˜¯32---è¡¨ç¤ºå¸¦æœ‰äº‹ä»¶ç›‘å¬å™¨çš„å…ƒç´ </span>
  STABLE_FRAGMENT = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">6</span>,   <span class="hljs-comment">// --å–å€¼æ˜¯64---è¡¨ç¤ºå…¶å­é¡ºåºä¸å˜ï¼Œä¸ä¼šæ”¹å˜è‡ªé¡ºåºçš„ç‰‡æ®µã€‚ </span>
  KEYED_FRAGMENT = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>, <span class="hljs-comment">// --å–å€¼æ˜¯128---è¡¨ç¤ºå¸¦æœ‰é”®æ§æˆ–éƒ¨åˆ†é”®æ§å­å…ƒç´ çš„ç‰‡æ®µã€‚</span>
  UNKEYED_FRAGMENT = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>, <span class="hljs-comment">// --å–å€¼æ˜¯256---å­èŠ‚ç‚¹æ— keyç»‘å®šçš„ç‰‡æ®µï¼ˆfragmentï¼‰</span>
  NEED_PATCH = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">9</span>,   <span class="hljs-comment">// --å–å€¼æ˜¯512---è¡¨ç¤ºåªéœ€è¦éå±æ€§è¡¥ä¸çš„å…ƒç´ ï¼Œä¾‹å¦‚refæˆ–hooks</span>
  DYNAMIC_SLOTS = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">10</span>,  <span class="hljs-comment">// --å–å€¼æ˜¯1024---è¡¨ç¤ºå…·æœ‰åŠ¨æ€æ’æ§½çš„å…ƒç´ </span>
</div></code></pre>
<ul>
<li>äºŒ ã€hoistStatic  é™æ€æå‡
<ul>
<li>vue2.0ä¸­ï¼Œåœ¨æ›´æ–°æ—¶ï¼Œå…ƒç´ å³ä½¿æ²¡æœ‰å˜åŒ–ï¼Œä¹Ÿä¼šé‡æ–°åˆ›å»ºè¿›è¡Œæ¸²æŸ“</li>
<li>vue3.0ä¸­ï¼Œä¸å‚ä¸æ›´æ–°çš„å…ƒç´ ï¼›ä¼šé™æ€æå‡ï¼Œåªåˆ›å»ºä¸€æ¬¡ä¸‹æ¬¡æ¸²æŸ“ç›´æ¥å¤ç”¨ã€‚</li>
<li>å› æ­¤åœ¨vue3.0ä¸­å¤ç”¨æ›´å¤šï¼Œåˆ›å»ºæ¬¡æ•°æ›´å°‘ï¼Œé€Ÿåº¦æ›´å¿«ã€‚è§ä¸‹æ–¹ç¤ºä¾‹ï¼š</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>    &lt;div&gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span>åœŸè±†å“‡~ <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é™æ€æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{msg}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'https://vue-next-template-explorer.netlify.app/'</span>&gt;</span>vue3.0ç¼–è¯‘åœ°å€<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span>
    &lt;<span class="hljs-regexp">/div&gt;
</span></div></code></pre>
<pre class="hljs"><code><div>    <span class="hljs-comment">/**
     * åœ¨ä¸‹æ–¹ç¼–è¯‘ä¸­(åœ¨optionsä¸­å‹¾é€‰hoistStatic)è¿›è¡Œé™æ€æå‡,
     * å¯ä»¥æ¸…æ™°çœ‹åˆ°ä¸æ›´æ–°å…ƒç´ æœªå‚ä¸é‡æ–°åˆ›å»º
    */</span>
<span class="hljs-keyword">const</span> _hoisted_1 = <span class="hljs-comment">/*#__PURE__*/</span>_createVNode(<span class="hljs-string">"a"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"åœŸè±†å“‡~ "</span>, <span class="hljs-number">-1</span> <span class="hljs-comment">/* HOISTED */</span>)

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>{
  <span class="hljs-keyword">return</span> (_openBlock(), _createBlock(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, [
    _hoisted_1,
    _createVNode(<span class="hljs-string">"p"</span>, { <span class="hljs-attr">style</span>: _ctx.myStyle }, <span class="hljs-string">"é™æ€æ–‡æœ¬"</span>, <span class="hljs-number">4</span> <span class="hljs-comment">/* STYLE */</span>),
    _createVNode(<span class="hljs-string">"p"</span>, <span class="hljs-literal">null</span>, _toDisplayString(_ctx.msg), <span class="hljs-number">1</span> <span class="hljs-comment">/* TEXT */</span>),
    _createVNode(<span class="hljs-string">"a"</span>, {
      <span class="hljs-attr">style</span>: _ctx.myStyle,
      <span class="hljs-attr">href</span>: <span class="hljs-string">"https://vue-next-template-explorer.netlify.app/"</span>
    }, <span class="hljs-string">"vue3.0ç¼–è¯‘åœ°å€"</span>, <span class="hljs-number">4</span> <span class="hljs-comment">/* STYLE */</span>)
  ]))
}
}
</div></code></pre>
<ul>
<li>ä¸‰ã€cachehandlers äº‹ä»¶ä¾¦å¬ç¼“å­˜
<ul>
<li>onClické»˜è®¤è§†ä¸ºåŠ¨æ€ç»‘å®šï¼Œå› æ­¤ä¼šè¿½è¸ªå®ƒçš„å˜åŒ–</li>
<li>äº‹ä»¶ç»‘å®šçš„å‡½æ•°ä¸ºåŒä¸€ä¸ªï¼Œå› æ­¤ä¸è¿½è¸ªå®ƒçš„å˜åŒ–ï¼Œç›´æ¥ç¼“å­˜åè¿›è¡Œå¤ç”¨</li>
<li>åŒæ ·çš„ï¼Œæˆ‘åœ¨ç¼–è¯‘ä¸­è¿›è¡Œæ¼”ç¤º</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>    &lt;div&gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">'Pooo'</span>&gt;</span>æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
    &lt;<span class="hljs-regexp">/div&gt;
</span></div></code></pre>
<pre class="hljs"><code><div>    <span class="hljs-comment">/**
     * å¼€å¯äº‹ä»¶ä¾¦å¬ç¼“å­˜å‰ï¼š
     * ä¸‹æ–¹ä¸ºå¸¸è§„ç¼–è¯‘åï¼Œå¯ä»¥çœ‹åˆ°é™æ€æ ‡è®°ä¸º8
     * æ—¢ç„¶æœ‰é™æ€æ ‡è®°ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¿›è¡Œæ¯”è¾ƒ
    */</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>{
  <span class="hljs-keyword">return</span> (_openBlock(), _createBlock(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, [
    _createVNode(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">onClick</span>: _ctx.Pooo }, <span class="hljs-string">"æŒ‰é’®"</span>, <span class="hljs-number">8</span> <span class="hljs-comment">/* PROPS */</span>, [<span class="hljs-string">"onClick"</span>])
  ]))
}
</div></code></pre>
<h4 id="%E7%84%B6%E5%90%8E%E6%88%91%E5%9C%A8options%E4%B8%AD%E6%89%93%E5%BC%80%E4%BA%8B%E4%BB%B6%E4%BE%A6%E5%90%AC%E7%BC%93%E5%AD%98cachehandlers"><strong>ç„¶åæˆ‘åœ¨optionsä¸­æ‰“å¼€äº‹ä»¶ä¾¦å¬ç¼“å­˜ï¼ˆcachehandlersï¼‰</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">/**
 * å¯ä»¥å‘ç°æ‰“å¼€ä¾¦å¬ç¼“å­˜åï¼Œæ²¡æœ‰é™æ€æ ‡è®°
 * åœ¨diffç®—æ³•ä¸­ï¼Œæ²¡æœ‰é™æ€æ ‡è®°çš„æ˜¯ä¸ä¼šè¿›è¡Œæ¯”è¾ƒå’Œè¿›è¡Œè¿½è¸ªçš„
*/</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>{
  <span class="hljs-keyword">return</span> (_openBlock(), _createBlock(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, [
    _createVNode(<span class="hljs-string">"button"</span>, {
      <span class="hljs-attr">onClick</span>: _cache[<span class="hljs-number">1</span>] || <span class="hljs-function">(<span class="hljs-params">_cache[<span class="hljs-number">1</span>] = (...args</span>) =&gt;</span> (_ctx.Pooo(...args)))
    }, <span class="hljs-string">"æŒ‰é’®"</span>)
  ]))
}
</div></code></pre>
<h4 id="%E4%BD%BF%E7%94%A8vue30%E6%8F%90%E4%BE%9B%E7%9A%84vite%E5%BF%AB%E9%80%9F%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><strong>ä½¿ç”¨vue3.0æä¾›çš„Viteå¿«é€Ÿåˆ›å»ºé¡¹ç›®</strong></h4>
<ul>
<li>Viteæ˜¯Vueä½œè€…å¼€å‘çš„ä¸€æ¬¾æ„å›¾å–ä»£webpackçš„å·¥å…·</li>
<li>åŸç†æ˜¯åˆ©ç”¨ES6çš„importå‘é€è¯·æ±‚åŠ è½½æ–‡ä»¶çš„ç‰¹æ€§ï¼Œè¿›è€Œæ‹¦æˆªï¼Œç„¶ååšé¢„ç¼–è¯‘ï¼Œçœå»webpackå†—é•¿çš„æ‰“åŒ…</li>
<li>ä½¿ç”¨æ­¥éª¤
<ul>
<li>å®‰è£…Viteå‘½ä»¤ï¼š <code>npm install -g create-vite-app</code></li>
<li>åˆ›å»ºVue3é¡¹ç›®ï¼š <code>create-vite-app PoooName</code></li>
<li>å®‰è£…ä¾èµ–ï¼š<code>cd PoooName / npm install / npm run dev</code></li>
<li>Vue3.0ä¸­å…¼å®¹2.0çš„å†™æ³•ï¼Œå…·ä½“ä»£ç åœ¨æ­¤æ–‡ä»¶åŒçº§çš„PoooNameé¡¹ç›®æ–‡ä»¶ä¸­</li>
</ul>
</li>
</ul>
<h4 id="vue30%E4%B8%AD%E7%9A%84-reactive-%E7%94%A8%E6%B3%95"><strong>vue3.0ä¸­çš„ reactive ç”¨æ³•</strong></h4>
<ul>
<li>åœ¨2.0ä¸­å¯¹äºä¸šåŠ¡å®ç°</li>
<li>éœ€è¦å…ˆåœ¨dataä¸­å˜æ›´è¡¥å……æ•°æ®ï¼Œç„¶ååœ¨<code>methods</code>æˆ–<code>watch</code>ä¸­è¡¥å……ä¸šåŠ¡é€»è¾‘</li>
<li>è¿™æ ·æ•°æ®å’Œé€»è¾‘æ˜¯åˆ†æ¨¡å—çš„ï¼ŒæŸ¥æ‰¾ä¸ä¾¿ï¼Œä¸åˆ©äºä¸šåŠ¡çš„ç®¡ç†å’Œç»´æŠ¤</li>
<li>ä¸ºè§£å†³è¿™æ ·çš„é—®é¢˜ï¼ŒVue3.0ä¸­åŠ å…¥äº† <code>reactive</code></li>
<li>Vue3.0æä¾›äº†setup ç»„åˆAPIçš„å…¥å£å‡½æ•°ï¼Œå¯ä»¥æŠŠæ•°æ®å’Œä¸šåŠ¡é€»è¾‘ç»„åˆåœ¨ä¸€èµ·</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>; <span class="hljs-comment">//åœ¨Vue3.0ä½¿ç”¨ä¸­éœ€è¦å¼•å…¥reactive</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"App"</span>,
  <span class="hljs-comment">//Vue3.0æä¾›äº†setup ç»„åˆAPIçš„å…¥å£å‡½æ•°</span>
  setup() {
    <span class="hljs-comment">/**
     * refä¸€èˆ¬ç”¨æ¥ç›‘å¬ç®€å•ç±»å‹å˜åŒ–ï¼ˆä¹Ÿå¯ä»¥ç”¨æ¥ç›‘å¬å¤æ‚ç±»å‹å˜åŒ–,å…ˆä¸è®¨è®ºï¼‰
     * é€šå¸¸ä½¿ç”¨reactiveç”¨æ¥ç›‘å¬å¤æ‚ç±»å‹å˜åŒ–ï¼ˆæ¯”å¦‚æ•°ç»„ã€å‡½æ•°ä¹‹ç±»ï¼‰
     * ä»¥ä¸‹ä¸ºä¸€ç§å¸¸è§„çš„å†™æ³•
     */</span>
    <span class="hljs-keyword">let</span> stus = reactive({ <span class="hljs-attr">stusList</span>: [****its data****], });
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeVeget</span>(<span class="hljs-params">index</span>) </span>{
      stus.stusList.splice(index, <span class="hljs-number">1</span>);
    }
    <span class="hljs-keyword">return</span> { stus, removeVeget };<span class="hljs-comment">// å¿…é¡»æš´éœ²å‡ºå»ï¼Œç»„ä»¶ä¸­æ‰å¯ä»¥ä½¿ç”¨</span>
  },
  <span class="hljs-attr">methods</span>: {},
};
</div></code></pre>
<ul>
<li>å¦ä¸€ç§æ›´åŠ ä¼˜é›…çš„å†™æ³•ï¼Œä¹Ÿæ˜¯<strong>éå¸¸éå¸¸</strong>æ¨èçš„å†™æ³•æ˜¯</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>; 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"App"</span>,
  setup() {
    <span class="hljs-keyword">let</span> {stus, removeVeget }=removeItem();<span class="hljs-comment">// ä¸‰ã€ç›´æ¥å£°æ˜ã€è·å–</span>
    <span class="hljs-keyword">return</span> { stus, removeVeget };<span class="hljs-comment">//å››ã€æš´éœ²ç»™å¤–ç•Œç»„ä»¶ä½¿ç”¨</span>
  },
  <span class="hljs-attr">methods</span>: {},
};
    <span class="hljs-comment">/**
     * ä¿è¯æ•°æ®å’Œä¸šåŠ¡ä¸åˆ†æ•£åˆ©äºæ›´æ–°ç»´æŠ¤
     * ä¹Ÿé¿å…äº†setupä¸­çš„å¤§é‡æ•°æ®å‡½æ•°å¡«å……
     * ä¹Ÿä¸éœ€è¦ä½¿ç”¨thisæŒ‡å‘Vueå®ä¾‹
    */</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeItem</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> stus = reactive({ <span class="hljs-attr">stusList</span>: [****its data****], });
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeVeget</span>(<span class="hljs-params">index</span>) </span>{
      stus.stusList.splice(index, <span class="hljs-number">1</span>);
    }
    <span class="hljs-keyword">return</span> {stus,removeVeget} <span class="hljs-comment">// äºŒã€æš´éœ²ç»™ç»„åˆAPIä½¿ç”¨</span>
  }
</div></code></pre>
<ul>
<li>åŠŸèƒ½åˆ†ç¦»ï¼š
<ul>
<li>ä¹ä¸€çœ‹ä¸Šæ–¹æŠŠå‡½æ•°æ•´åˆåˆ°ä¸‹æ–¹ï¼Œç„¶ååœ¨<code>setup</code>ä¸­å¼•ç”¨æ˜¯å¾ˆç®€æ´</li>
<li>è‹¥éœ€è¦çš„ä¸šåŠ¡åŠŸèƒ½å¤šäº†å‘¢ï¼Œæ¯”å¦‚å¢åŠ ä¸ª<code>updateItem</code>,<code>addItem</code></li>
<li>è™½ç„¶æ•°æ®å’Œé€»è¾‘ä»£ç è¿˜æ˜¯åœ¨ä¸€å—ï¼Œä½†æ˜¯å„ç§åŠŸèƒ½èšé›†åœ¨ä¸€å—è¿˜æ˜¯æ˜¾å¾—æ–‡ä»¶è‡ƒè‚¿</li>
<li>é‚£ä¹ˆè¿˜è¦ç»§ç»­ä¼˜åŒ–ï¼Œåˆ†ç¦»å„ä¸ªåŠŸèƒ½
<ol>
<li>æ–°å»ºä¸€ä¸ªå•ç‹¬çš„JSæ–‡ä»¶ï¼Œå¦‚remove.js</li>
<li>åœ¨APPæ–‡ä»¶ä¸­å¼•å…¥è¿™ä¸ªJSæ–‡ä»¶
3.è¿™æ ·å°±å¯ä»¥åœ¨å•ç‹¬çš„JSæ–‡ä»¶ä¸­å¯¹æŸä¸ªåŠŸèƒ½è¿›è¡Œç»´æŠ¤äº†</li>
</ol>
</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>; <span class="hljs-comment">//å¼•å…¥ä¾èµ–</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeItem</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-comment">//å®šä¹‰å‡½æ•°ï¼Œå®ç°åŠŸèƒ½</span>
  <span class="hljs-keyword">let</span> stus = reactive({
    <span class="hljs-attr">stusList</span>: [
      { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">Name</span>: <span class="hljs-string">"potato"</span>, <span class="hljs-attr">price</span>: <span class="hljs-string">"2.5"</span> },
      { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">Name</span>: <span class="hljs-string">"tomato"</span>, <span class="hljs-attr">price</span>: <span class="hljs-string">"3.5"</span> },
      { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">Name</span>: <span class="hljs-string">"cucumber"</span>, <span class="hljs-attr">price</span>: <span class="hljs-string">"4.5"</span> },
    ],
  });
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeVeget</span>(<span class="hljs-params">index</span>) </span>{
    stus.stusList.splice(index, <span class="hljs-number">1</span>);
  }
  <span class="hljs-keyword">return</span> {stus,removeVeget} 
}
<span class="hljs-keyword">export</span>  {removeItem};<span class="hljs-comment">//æš´éœ²ç»™å¤–ç•Œä½¿ç”¨</span>
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">/*é‚£ä¹ˆä¸»æ–‡ä»¶å°±å˜æˆäº†å¦‚ä¸‹å½¢å¼ï¼ˆå•ç‹¬JSæ–‡ä»¶ä¸­å·²ç»å¼•å…¥reactiveï¼‰*/</span>
<span class="hljs-keyword">import</span> { removeItem } <span class="hljs-keyword">from</span> <span class="hljs-string">"./remove"</span>; <span class="hljs-comment">//å¯¼å…¥åˆ é™¤çš„ä¸šåŠ¡é€»è¾‘æ¨¡å—</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
<span class="hljs-attr">name</span>: <span class="hljs-string">"App"</span>,
setup() {
  <span class="hljs-keyword">let</span> { stus, removeVeget } = removeItem();
  <span class="hljs-keyword">return</span> { stus, removeVeget };
},
<span class="hljs-attr">methods</span>: {},
};
</div></code></pre>
<h4 id="vue30%E4%B8%AD%E7%9A%84-composition-api%E6%9C%AC%E8%B4%A8"><strong>vue3.0ä¸­çš„ Composition APIæœ¬è´¨</strong></h4>
<ul>
<li>Option APIï¼šå³åœ¨APPä¸­ä¸ºå®ç°ä¸šåŠ¡é€»è¾‘è¿›è¡Œçš„é…ç½®
<ul>
<li>åœ¨2.0ä¸­æ¯”å¦‚ä½ è¦å®ç°ä¸€ä¸ªç‚¹å‡»æŒ‰é’®ï¼Œå¼¹å‡ºæç¤ºè¯­åŠŸèƒ½ï¼Œä½ éœ€è¦
<ol>
<li>åˆ©ç”¨ <code>Opaction API</code></li>
<li>åœ¨ <code>data</code> ä¸­é…ç½®æ•°æ®</li>
<li>åœ¨ <code>methods</code> ä¸­é…ç½®ç›¸åº”å‡½æ•°</li>
</ol>
</li>
<li>åœ¨3.0ä¸­é€šè¿‡ä¸Šæ–¹ <code>reactive</code> çš„çŸ¥è¯†ç‚¹æˆ‘ä»¬çŸ¥é“ï¼Œå®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œä½ éœ€è¦
<ol>
<li>åˆ©ç”¨ <code>Composition API</code></li>
<li>åœ¨ <code>setup</code> ä¸­å®šä¹‰æ•°æ®ï¼Œç¼–å†™å‡½æ•°</li>
<li>é€šè¿‡ <code>return{ æ•°æ®,æ–¹æ³•}</code>æš´éœ²å‡ºå»</li>
</ol>
</li>
<li>å…¶å® <code>Composition</code> (ä¹Ÿå«æ³¨å…¥API)æœ¬è´¨æ˜¯åœ¨è¿è¡Œæ—¶
<ol>
<li>æŠŠæš´éœ²å‡ºæ¥çš„æ•°æ®æ³¨å…¥åˆ° <code>opaction</code> ä¸­çš„ <code>data</code></li>
<li>æŠŠæš´éœ²å‡ºæ¥çš„å‡½æ•°æ³¨å…¥åˆ° <code>opaction</code> ä¸­çš„ <code>methods</code></li>
</ol>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ³¨: å…·ä½“å®ƒå’‹åŒºåˆ†æ•°æ®è¿˜æ˜¯å‡½æ•°ç”¨ä»¥æ³¨å…¥åˆ°ç›¸åº”é…ç½®ä¸­çš„ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼ˆ <strong><s>æ ‡å¿—ä½orä¼ å‚é¡ºåºï¼Ÿ</s></strong> ï¼‰</p>
</blockquote>
<ul>
<li>å°ç»“ï¼š
<ul>
<li><code>Opaction API</code>ä¸­å¯¹é…ç½®é¡¹éƒ½è¿›è¡Œäº†è§„å®šï¼Œæ¯”å¦‚ï¼š
<ul>
<li>åœ¨dataä¸­é…ç½®æ•°æ®ï¼Œmethodsä¸­ç¼–å†™æ–¹æ³•ï¼Œ <code>watch </code>ä¸­è¿›è¡Œç›‘å¬ã€‚</li>
<li>ä¿å§†å¼çš„åˆ†é…è¾ƒä¸ºæ¸…æ™°ï¼Œä½†ä¹Ÿå¯¹ä»£ç å±‚å±‚åˆ†å‰²ï¼Œç»´æŠ¤è¦æ‰’æ‹‰åŠå¤©è·³æ¥è·³</li>
</ul>
</li>
<li><code>Composition</code>ä¸­æ›´åŠ è‡ªç”±ï¼Œæ¯”å¦‚ï¼š
<ul>
<li>ä¸ç”¨æ‹…å¿ƒå„ç§thisæŒ‡å‘</li>
<li>éšæ„è¿›è¡Œæ¨¡å—åˆ†å‰²å¯¼å‡ºï¼Œç»´æŠ¤æ—¶æŸ¥æ‰¾å›ºå®šæ¨¡å—æ–‡ä»¶</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%AD%E7%9A%84-setup"><strong>ç”Ÿå‘½å‘¨æœŸä¸­çš„ setup</strong></h4>
<ul>
<li><strong>setupçš„æ‰§è¡Œæ—¶æœºåœ¨<code>beforeCreate</code>å’Œ<code>created</code>ä¹‹å‰ï¼Œå‰å‰å‰</strong>
<ul>
<li>è¿™å…¶å®æ ¹æ®ä¸Šæ–¹æ€»ç»“çš„å†…å®¹ï¼Œç”¨å±è‚¡ä¹Ÿèƒ½æƒ³å‡ºæ¥åŸå› </li>
<li>åœ¨Vueç”Ÿå‘½å‘¨æœŸä¸­æˆ‘ä»¬çŸ¥é“ï¼š
<ol>
<li><code>beforeCreate </code>æ—¶ï¼Œåˆšåˆå§‹åŒ–ä¸€ä¸ªç©º <code>Vue </code>å®ä¾‹å¯¹è±¡ï¼Œ <code>data </code>å’Œ <code>methods </code>ä¸­æ•°æ® <strong>æœªåˆå§‹åŒ–</strong></li>
<li><code>created </code>æ‰§è¡Œæ—¶ï¼Œdataå’Œmethodså·²ç»<strong>åˆå§‹åŒ–å®Œæ¯•</strong></li>
<li><code>Composition</code> éœ€è¦æŠŠsetupä¸­çš„æ•°æ®å¯¹åº”æ³¨å…¥åˆ° <code>data </code>å’Œ <code>methods </code>ä¸­å»</li>
<li>å¾ˆæ˜¾ç„¶setupå¿…é¡»è¦åœ¨ <code>created </code>ä¹‹å‰æ‰§è¡Œ</li>
</ol>
</li>
<li>ä¹Ÿå› æ­¤ï¼Œè‹¥ä½ åœ¨Vue3.0ä¸­è¿›è¡Œæ··åˆå¼€å‘ï¼Œä¸å¯ä»¥åœ¨ <code>setup </code>ä¸­ä½¿ç”¨ <code>data </code>ä¸­çš„æ•°æ®å’Œ <code>methods </code>ä¸­çš„æ–¹æ³•</li>
<li>åœ¨3.0ä¸­<code>setup </code>é‡Œçš„thisä¹Ÿè¢«ä¿®æ”¹ä¸ºäº†<code>undefiend</code></li>
<li>åœ¨3.0ä¸­<code>setup </code>é‡Œä¹Ÿä¸å¯ä»¥ä½¿ç”¨å¼‚æ­¥</li>
<li>ï¼ˆä¸‹æ–¹è´´çš„å›¾æˆ‘ä¹ŸåŠ å…¥äº†æ—é‡Šï¼Œå¯å¸®åŠ©ä½ å›æƒ³ä¸‹ç”Ÿå‘½å‘¨æœŸï¼‰
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd4270cf4ae6499fa790cc813433eea5~tplv-k3u1fbpfcp-watermark.image" alt=""></li>
</ul>
</li>
</ul>
<h4 id="%E4%BB%80%E4%B9%88%E6%98%AF-reactive"><strong>ä»€ä¹ˆæ˜¯ reactive</strong></h4>
<ul>
<li><code>reactive</code>æ˜¯<code>VUE3.0</code>ä¸­æä¾›çš„å®ç°å“åº”å¼æ•°æ®çš„æ–¹æ³•</li>
<li>åœ¨Vue2.0ä¸­ä½¿ç”¨çš„æ˜¯<code>defineProperty</code>æ¥å®ç°çš„ï¼ˆæˆ‘è‡ªå·±ä¹Ÿæ‰‹åŠ¨å®ç°è¿‡ğŸ‘‰ <a href="https://www.xipengheng.cn/?paged=2&amp;cat=69">ç‚¹å‡»</a>ï¼‰</li>
<li>è€Œ<code>VUE3.0</code>ä¸­ä½¿ç”¨çš„æ˜¯ES6é‡Œçš„<code>proxy</code>å®ç°çš„</li>
<li><code>reactive</code>ä¸­éœ€è¦æ³¨æ„çš„ç‚¹ï¼š
<ul>
<li>ä¼ é€’ç»™å®ƒçš„ç±»å‹å¿…é¡»æ˜¯å¯¹è±¡ï¼ˆJSONæˆ–è€…arræ•°ç»„ï¼‰</li>
<li>å¹¶ä¸”å®ƒä¼šè‡ªåŠ¨æŠŠä¼ é€’è¿›æ¥æ¡ä»¶å†èµ‹å€¼ç»™<code>Proxy</code>å¯¹è±¡</li>
<li>è‹¥ä¼ é€’çš„ä¸ºä¸Šè¿°ä»¥å¤–çš„å¯¹è±¡
<ol>
<li>åœ¨æ–¹æ³•ä¸­ç›´æ¥ä¿®æ”¹å®ƒï¼Œç•Œé¢ä¸Šå®ƒä¹Ÿä¸ä¼šè‡ªåŠ¨æ›´æ–°</li>
<li>è‹¥æƒ³æ›´æ–°åªèƒ½é€šè¿‡é‡æ–°èµ‹å€¼çš„æ–¹å¼</li>
</ol>
</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>  <span class="hljs-comment">/*ç¤ºä¾‹å¦‚ä¸‹*/</span>
  setup() {
    <span class="hljs-keyword">let</span> testJson=reactive({
      <span class="hljs-attr">tip</span>:<span class="hljs-string">'its a Jsonï¼'</span>
    })
    <span class="hljs-keyword">let</span> testArray=reactive([<span class="hljs-string">'first'</span>,<span class="hljs-string">'second'</span>,<span class="hljs-string">'third'</span>])
    <span class="hljs-keyword">let</span> testString=reactive(<span class="hljs-string">'Just a string'</span>)
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showProxyPar</span>(<span class="hljs-params"></span>)</span>{
      testJson.tip=<span class="hljs-string">'changed'</span>;
      testArray[<span class="hljs-number">2</span>]=<span class="hljs-string">'selected'</span>;
      testString=<span class="hljs-string">'hengxipeng'</span>;<span class="hljs-comment">//ç”±äºä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å³ä½¿æ›´æ”¹è§†å›¾ä¹Ÿä¸ä¼šåŒæ­¥æ›´æ–°</span>
      <span class="hljs-built_in">console</span>.log(testJson);<span class="hljs-comment">// ProxyÂ {tip: "changed"}</span>
      <span class="hljs-built_in">console</span>.log(testArray);<span class="hljs-comment">// ProxyÂ {0: "first", 1: "second", 2: "selected"}</span>
      <span class="hljs-built_in">console</span>.log(testString);<span class="hljs-comment">// hengxipeng</span>
    }
    <span class="hljs-keyword">return</span> { testJson,testArray,testString,showProxyPar };
  },
</div></code></pre>
<ul>
<li>æ•ˆæœæ­£å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç¬¦åˆä¼ é€’æ¡ä»¶çš„å‚æ•°ä¼šå†èµ‹å€¼ç»™Proxyï¼Œå¹¶ä¸”ä¿®æ”¹å®ƒä¹Ÿä¼šç›´æ¥å½±å“è§†å›¾
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7ed8d67f20454398b683ef68254555a1~tplv-k3u1fbpfcp-watermark.image" alt=""></li>
</ul>
<h4 id="%E4%BB%80%E4%B9%88%E6%98%AF-ref"><strong>ä»€ä¹ˆæ˜¯ ref</strong></h4>
<ul>
<li>å®ƒä¹Ÿæ˜¯å®ç°å“åº”å¼æ•°æ®çš„æ–¹æ³•</li>
<li><code>reactivce</code>å‘æ¥éƒ½æ˜¯è¿›è¡Œä¼ é€’å¯¹è±¡ï¼Œå®é™…å¼€å‘ä¸­è‹¥åªæƒ³æ›´æ”¹æŸç®€å•å˜é‡åˆ™ä¼šæ˜¾å¾—å¤§æå°ç”¨</li>
<li>æ‰€ä»¥<code>vue3</code>æä¾›äº†<code>ref</code>æ–¹æ³•ï¼Œæ¥å®ç°å¯¹ç®€å•å€¼çš„ç›‘å¬</li>
<li><code>ref</code>æœ¬è´¨ä¹Ÿæ˜¯ä½¿ç”¨<code>reactive</code>ï¼Œç»™<code>ref</code>çš„èµ‹å€¼ï¼Œå®ƒåº•å±‚ä¼šè‡ªåŠ¨è½¬åŒ–</li>
</ul>
<pre class="hljs"><code><div>  <span class="hljs-comment">/**
   * å®è´¨æ˜¯ ref('its a string')==&gt;reactive({value:'its a string'})
   * ä¹Ÿå› æ­¤æ›´æ”¹æ—¶åº”è¯¥ testRef.value=XX æ‰èƒ½æ›´æ”¹
   * ï¼ˆä½¿ç”¨çš„æ—¶å€™ä¸å¿…å†åŠ  valueï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼‰
   */</span>
  setup() {
    <span class="hljs-keyword">let</span> testRef = ref(<span class="hljs-string">'its a string'</span>);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showProxyPar</span>(<span class="hljs-params"></span>) </span>{
      testRef.value=<span class="hljs-string">'ref_string'</span>
      <span class="hljs-built_in">console</span>.log(testRef);
    }
    <span class="hljs-keyword">return</span> { testRef, showProxyPar };
  },
</div></code></pre>
<ul>
<li>å¦‚ä¸‹å›¾</li>
</ul>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd9fd7eedcc34092a523d445bbc21595~tplv-k3u1fbpfcp-watermark.image" alt=""></p>
<h4 id="ref-%E5%92%8C-reactive-%E4%B9%8B%E9%97%B4%E7%9A%84%E4%B8%8D%E5%90%8C"><strong>ref å’Œ reactive ä¹‹é—´çš„ä¸åŒ</strong></h4>
<ul>
<li>é€šè¿‡ä»¥ä¸Šå¾—çŸ¥ï¼Œä½¿ç”¨<code>ref</code>å…¶å®ç›¸å½“äºä½¿ç”¨<code>reactive</code>ï¼Œåªæ˜¯çœç•¥äº†æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤</li>
<li><code>ref</code>ä¸­åº•å±‚ä¼šæ·»åŠ ä¸€ä¸ª<code>value</code>çš„é”®ï¼Œå¹¶ä¸”åœ¨è§†å›¾ä¸­å¯çœç•¥è°ƒç”¨<code>value</code>
<ul>
<li>ç»è¿‡æˆ‘è‡ªå·±æµ‹è¯•
<ol>
<li>ä½¿ç”¨<code>reactive</code>ï¼Œåˆ›å»ºä¸€ä¸ªé”®å€¼ä¸º<code>value</code>çš„<code>Json</code>å¯¹è±¡ï¼ŒéªŒè¯æ˜¯å¦å¯çœç•¥<code>value</code>è°ƒç”¨ï¼ˆ<strong>ä¸å¯ä»¥</strong>ï¼‰</li>
<li>å¾—çŸ¥ï¼Œåªæœ‰ä½¿ç”¨<code>ref</code>ä¼ é€’å‚æ•°æ—¶ï¼Œè§†å›¾æ‰å…è®¸çœç•¥<code>value</code>è°ƒç”¨</li>
</ol>
</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>  <span class="hljs-comment">/**
   * Vueåœ¨è§£ææ—¶ï¼Œé€šè¿‡  __v_isRef æ¥åˆ¤å®šå½“å‰å‚æ•°æ˜¯å¦ç”± ref ä¼ é€’å‡ºæ¥çš„
   * æ˜¯çš„è¯ï¼Œåˆ™ä¼šè‡ªåŠ¨åœ¨è°ƒç”¨å½“å‰å‚æ•°æ—¶æ·»åŠ  value
   */</span>
      <span class="hljs-attr">__v_isRef</span>: <span class="hljs-literal">true</span>
      <span class="hljs-attr">_rawValue</span>: <span class="hljs-string">"its a string"</span>
      <span class="hljs-attr">_shallow</span>: <span class="hljs-literal">false</span>
      <span class="hljs-attr">_value</span>: <span class="hljs-string">"its a string"</span>
      <span class="hljs-attr">value</span>: <span class="hljs-string">"its a string"</span>
</div></code></pre>
<ul>
<li>å…¶ä¸­<code>Vue3.0</code>ä¸­æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œ<code>isReactive</code>å’Œ<code>isRef</code>ç”¨æ¥åˆ¤å®šæ•°æ®æ¥æº</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> {isRef,isReactive } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
  setup() {
    <span class="hljs-keyword">let</span> testReactive = reactive({<span class="hljs-attr">value</span>:<span class="hljs-string">'its a string'</span>});
    <span class="hljs-keyword">let</span> testRef = ref(<span class="hljs-string">'its a string'</span>);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showProxyPar</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ£€æµ‹æ˜¯å¦æ˜¯Ref'</span>,isRef(testReactive));<span class="hljs-comment">// false</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ£€æµ‹æ˜¯å¦æ˜¯Ref'</span>,isRef(testRef));<span class="hljs-comment">// true</span>
    }
    <span class="hljs-keyword">return</span> { testRef,testReactive, showProxyPar };
  }
</div></code></pre>
<h4 id="%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC"><strong>é€’å½’ç›‘å¬</strong></h4>
<ul>
<li>é€šå¸¸æƒ…å†µä¸‹<code>ref</code>å’Œ<code>reactive</code>éƒ½ä¼šç›‘å¬æ•°æ®å˜åŒ–</li>
</ul>
<blockquote>
<p>éªŒè¯å¦‚ä¸‹ï¼Œç‚¹å‡»æŒ‰é’®è§¦å‘<code>recursion</code> é¡µé¢æ˜¾ç¤ºéƒ½ä¼šæ”¹å˜</p>
</blockquote>
<pre class="hljs"><code><div><span class="hljs-comment">//éªŒè¯ref åªéœ€æ·»åŠ valueå³å¯ï¼Œå¦‚ï¼š parse.value.type='fruit';</span>
  setup() {
    <span class="hljs-keyword">let</span> parse = reactive({
      <span class="hljs-attr">type</span>: <span class="hljs-string">"vegetables"</span>,
      <span class="hljs-attr">suchAS</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"tomato"</span>,
        <span class="hljs-attr">info</span>: {
          <span class="hljs-attr">price</span>: <span class="hljs-string">"0.4å…ƒ/kg"</span>,
          <span class="hljs-attr">size</span>: {
            <span class="hljs-attr">big</span>: <span class="hljs-string">"50g"</span>,
            <span class="hljs-attr">small</span>: <span class="hljs-string">"20g"</span>,
          },
        },
      },
    });
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recursion</span>(<span class="hljs-params"></span>) </span>{
      parse.type=<span class="hljs-string">'fruit'</span>;
      parse.suchAS.name=<span class="hljs-string">'cucumber'</span>;
      parse.suchAS.info.price=<span class="hljs-string">'0.8å…ƒ/kg'</span>;
      parse.suchAS.info.size.small=<span class="hljs-string">'70g'</span>; 
      parse.suchAS.info.size.big=<span class="hljs-string">'90g'</span>;
    }
    <span class="hljs-keyword">return</span> { parse,recursion };
  },
</div></code></pre>
<ul>
<li>å½“æ•°æ®é‡åºå¤§ï¼Œéœ€è¦è€ƒè™‘æ€§èƒ½æ—¶
<ul>
<li>åœ¨&lt; <strong>ä»€ä¹ˆæ˜¯ <code>reactive</code></strong> &gt;ä¸­æ€»ç»“çŸ¥é“ï¼š
<ul>
<li><code>reactive</code>å’Œ<code>ref</code>é€šè¿‡é€’å½’å–å‡ºå‚æ•°ä¸­æ‰€æœ‰å€¼ï¼ŒåŒ…è£…ä¸º<code>proxy</code>å¯¹è±¡</li>
<li>é€’å½’çš„ä¼˜ä¸åŠ£æˆ‘æ€»ç»“è¿‡ï¼Œæ¶‰åŠå†…å­˜ä¸­çš„å‹æ ˆå’Œæ ˆé¡¶å¼¹å‡ºç­‰ï¼Œå»ºè®®å›é¡¾ä¸‹ğŸ‘‰<a href="https://juejin.cn/post/6870823876591517704">ç‚¹å‡»</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="%E9%9D%9E%E9%80%92%E5%BD%92%E7%9B%91%E5%90%AC"><strong>éé€’å½’ç›‘å¬</strong></h4>
<ul>
<li>ä¸Šé¢çŸ¥é“äº†é€’å½’ç›‘å¬ä¸Šçš„ç§ç§åŠ£åŠ¿ï¼Œè€Œ<code>Vue3.0</code>ä¹Ÿæä¾›äº†è§£å†³æ–¹æ¡ˆ
<ul>
<li>éé€’å½’ç›‘å¬ï¼Œå³ï¼šåªç›‘å¬æ•°æ®çš„ç¬¬ä¸€å±‚ã€‚æ–¹æ¡ˆå¦‚ä¸‹ï¼š
<ol>
<li>å¼•å…¥<code>Vue3.0</code>ä¸­æä¾›çš„<code>shallowReactive</code></li>
<li>æ”¹ç”¨ <code>shallowReactive({})</code>ä¼ é€’å‚æ•°</li>
<li>ç»è¿‡è°ƒè¯•å‘ç°ï¼Œåªæœ‰ç¬¬ä¸€å±‚åŒ…è£…æˆäº†<code>proxy</code>å¯¹è±¡ï¼Œå¦‚ä¸‹å›¾
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/07ca0d8188ec4eddb6259388acb8614b~tplv-k3u1fbpfcp-watermark.image" alt=""></li>
</ol>
</li>
<li>è€Œå¯¹äº<code>ref</code>å¯¹åº”çš„<code>shallowRef</code>éé€’å½’ç›‘å¬åˆ™æ¯”è¾ƒç‰¹æ®Š
<ol>
<li>é¦–å…ˆè¯•å¼•å…¥<code>Vue3.0</code>ä¸­å®˜æ–¹æä¾›çš„<code>shallowRef</code></li>
<li>åŸç†ä¸Šä¸<code>reactive</code>ç›¸åŒï¼Œåªæ˜¯å®ƒå¹¶ä¸ä¼šç›‘å¬<code>JSON</code>ç¬¬ä¸€å±‚æ•°æ®</li>
<li>è€Œæ˜¯è¦ç›´æ¥ä¿®æ”¹<code>value</code>çš„å€¼ï¼Œè¿™æ ·è§†å›¾æ‰ä¼šåŒæ­¥æ›´æ–°</li>
</ol>
</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recursion</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">/** * shallowRef å¯¹ç¬¬ä¸€å±‚ä¿®æ”¹ä¸ä¼šç›‘å¬ï¼Œæ‰€ä»¥è§†å›¾ä¸å˜ */</span>
      parse.value.type=<span class="hljs-string">'fruit'</span>;
      parse.value.suchAS.name=<span class="hljs-string">'cucumber'</span>;
      parse.value.suchAS.info.price=<span class="hljs-string">'0.8å…ƒ/kg'</span>;
      parse.value.suchAS.info.size.small=<span class="hljs-string">'70g'</span>; 
      parse.value.suchAS.info.size.big=<span class="hljs-string">'90g'</span>;
      <span class="hljs-comment">/** * æ­£ç¡®åšæ³•åº”è¯¥æ˜¯æ•´ä¸ªä¿®æ”¹ value */</span>
        parse.value = {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"fruit"</span>,
        <span class="hljs-attr">suchAS</span>: {
          <span class="hljs-attr">name</span>: <span class="hljs-string">"cucumber"</span>,
          <span class="hljs-attr">info</span>: {
            <span class="hljs-attr">price</span>: <span class="hljs-string">"0.8å…ƒ/kg"</span>,
            <span class="hljs-attr">size</span>: {
              <span class="hljs-attr">big</span>: <span class="hljs-string">"70g"</span>,
              <span class="hljs-attr">small</span>: <span class="hljs-string">"90g"</span>,
            },},},};}
</div></code></pre>
<blockquote>
<p>æ³¨æ„ç‚¹ï¼šè™½ç„¶ä»–ä»¬åªå¯¹ç¬¬ä¸€å±‚è¿›è¡Œäº†ç›‘å¬ï¼Œä½†è‹¥æ°å·§æ¯æ¬¡éƒ½æ›´æ”¹äº†ç¬¬ä¸€å±‚æ•°æ®ï¼Œåˆ™ä¹Ÿä¼šå¼•èµ·ä¸‹æ–¹æ•°æ®å’Œè§†å›¾çš„åŒæ­¥æ›´æ–°ï¼Œæ­¤æ—¶<code>shallowReactive</code>æˆ–è€…<code>shallowRef</code>å°±å’Œ<code>reactiveã€Ref</code>æ•ˆæœä¸€æ¨¡ä¸€æ ·ï¼</p>
</blockquote>
<h4 id="%E6%95%B0%E6%8D%AE%E7%9B%91%E5%90%AC%E8%A1%A5%E5%85%85"><strong>æ•°æ®ç›‘å¬è¡¥å……</strong></h4>
<ul>
<li>é€šè¿‡ä»¥ä¸Šè¿™äº›çŸ¥è¯†ç‚¹å¯çŸ¥ï¼š
<ul>
<li><code>ref</code>å’Œ<code>reactive</code>ç›‘å¬æ¯ä¸€å±‚æ•°æ®ï¼Œå“åº”å¥½ä½†é€’å½’å–å€¼æ€§èƒ½å·®ã€‚</li>
<li><code>shallowReactive</code>å’Œ<code>shallowRef</code>ç›‘å¬ç¬¬ä¸€å±‚ï¼ˆæˆ–valueï¼‰ï¼Œæ€§èƒ½å¥½ä½†æ›´æ–°å€¼è¾ƒéº»çƒ¦</li>
<li><code>shallowRef</code>ä¸­ï¼Œä¸ºäº†æ•°æ®å’Œè§†å›¾ä¸€è‡´ï¼Œæ›´æ–°å€¼è¦æ›´æ–°æ•´ä¸ª<code>parse.value</code>å¤ªç¹ç</li>
<li>åœºæ™¯ï¼šè‹¥æˆ‘æ›´æ–°æ•°æ®çš„ç¬¬ä¸‰å±‚ï¼Œä¸æ•´ä¸ªæ›´æ–°<code>value</code>è¡Œä¸è¡Œï¼Ÿ
<ol>
<li>è¿™å°±ç”¨åˆ°äº†<code>Vue3.0</code>ä¸º<code>ref</code>å‡†å¤‡çš„<code>triggerRef</code>(ä¸ç”¨æŸ¥å•¦ å°±ä¸€ä¸ª)</li>
<li>ä½œç”¨ï¼šæ ¹æ®ä¼ å…¥çš„æ•°æ®ï¼Œä¸»åŠ¨å»æ›´æ–°è§†å›¾
<ul>
<li>è€è§„çŸ©ï¼Œ<code>import {shallowRef, triggerRef } from &quot;vue&quot;</code></li>
<li>æ”¹å®Œéé¦–å±‚çš„æ•°æ®ï¼Œè€Œä½ ä½¿ç”¨çš„æ˜¯<code>shallowRef</code>è¿˜ä¸æƒ³æ•´ä¸ªæ›´æ–°<code>value</code></li>
<li>ä½¿ç”¨<code>triggerRef</code>å¤§æ³•ï¼Œä¼ å…¥æ•´ä¸ªå¯¹è±¡ï¼Œå°±å¥½å•¦</li>
<li>ï¼ˆä½¿ç”¨<code>reactive</code>ä¼ å…¥çš„æ•°æ®ï¼Œæ— æ³•è§¦å‘<code>triggerRef</code>ï¼‰</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recursion</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">/**
       *  æ–¹æ³•ä¸€ã€æ‰‹åŠ¨æ›´æ–°
      parse.value = {
        type: "fruit",
        suchAS: {
          name: "cucumber",
          info: {
            price: "0.8å…ƒ/kg",
            size: {
              big: "70g",
              small: "90g",
          },},},};
       */</span>
      <span class="hljs-comment">/** * æ–¹æ³•è€Œã€ä½¿ç”¨ triggerRef */</span>
      parse.value.suchAS.info.price=<span class="hljs-string">'0.8å…ƒ/kg'</span>;
      triggerRef(parse)
    }
</div></code></pre>
<h4 id="%E6%95%B0%E6%8D%AE%E7%9B%91%E5%90%AC%E6%96%B9%E5%BC%8F%E9%80%89%E6%8B%A9"><strong>æ•°æ®ç›‘å¬æ–¹å¼é€‰æ‹©</strong></h4>
<ul>
<li>æ­£å¸¸æ•°æ®é‡æ—¶ï¼Œé€šå¸¸ä½¿ç”¨<code>ref</code>å’Œ<code>reactive</code>ï¼ˆé€’å½’ç›‘å¬ï¼‰å³å¯æ»¡è¶³ä¸šåŠ¡éœ€è¦</li>
<li>å½“æ•°æ®é‡åºå¤§ä¸”æ³¨é‡æ€§èƒ½æ—¶ï¼Œå°±éœ€è€ƒè™‘<code>shallowReactive</code>å’Œ<code>shallowRef</code>äº†ï¼ˆéé€’å½’ç›‘å¬ï¼‰</li>
</ul>
<h4 id="shallowref%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><strong><code>shallowRef</code>åº•å±‚åŸç†</strong></h4>
<ul>
<li>åœ¨çœ‹ <code>ref</code> æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒçš„æœ¬è´¨å…¶å®æ˜¯ <code>reactive({value:XX})</code></li>
<li>é‚£ä¹ˆ <code>shallowRef</code> å…¶å®æ˜¯ <code>shallowReactive({value:XX})</code>
<ul>
<li>å› ä¸ºé€šè¿‡<code>shallowRef</code> åˆ›å»ºçš„æ•°æ®ï¼Œå®ƒç›‘å¬çš„æ˜¯ <code>.value</code> çš„å˜åŒ–</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>  <span class="hljs-keyword">let</span> state1=shallowRef({
    <span class="hljs-attr">a</span>:<span class="hljs-string">'a'</span>,
    <span class="hljs-attr">b</span>:{
      <span class="hljs-attr">b_1</span>:<span class="hljs-string">'b_1'</span>,
      <span class="hljs-attr">b_2</span>:<span class="hljs-string">'b_2'</span>
    }
  })
  <span class="hljs-comment">//--å…¶å®æ˜¯å¦‚ä¸‹æ‰€ç¤º</span>
  <span class="hljs-keyword">let</span> state2=shallowReactive({
    <span class="hljs-attr">value</span>:{
        <span class="hljs-attr">a</span>:<span class="hljs-string">'a'</span>,
        <span class="hljs-attr">b</span>:{
          <span class="hljs-attr">b_1</span>:<span class="hljs-string">'b_1'</span>,
          <span class="hljs-attr">b_2</span>:<span class="hljs-string">'b_2'</span>
        }
    }
  })
</div></code></pre>
<h4 id="toraw"><strong>toRaw</strong></h4>
<ul>
<li>åœ¨ä¹‹å‰çš„çŸ¥è¯†ä½“ç³»ä¸­æˆ‘ä»¬çŸ¥é“
<ul>
<li><code>setup</code> ä¸­å®šä¹‰å‚æ•°å¯¹è±¡ï¼Œåœ¨å‡½æ•°ä¸­ç›´æ¥ä¿®æ”¹é¡µé¢æ˜¯ä¸ä¼šåŒæ­¥æ›´æ–°ã€‚</li>
<li>éœ€è¦åˆ©ç”¨ <code>Ref</code> æˆ–è€… <code>reactive</code> è¿›è¡ŒåŒ…è£…ï¼Œè¿™æ ·ä¿®æ”¹æ‰ç”Ÿæ•ˆ</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>    <span class="hljs-keyword">let</span> obj={ <span class="hljs-attr">name</span>:<span class="hljs-string">'èŠ±èŠ±'</span>,<span class="hljs-attr">age</span>:<span class="hljs-string">'3'</span>}
    <span class="hljs-keyword">let</span> test=reactive(obj);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFun</span>(<span class="hljs-params"></span>) </span>{test.name=<span class="hljs-string">'ä¹ä¹'</span>;}
</div></code></pre>
<ul>
<li>
<ul>
<li><code>obj</code> å’Œ <code>test</code>æ˜¯å¼•ç”¨å…³ç³»</li>
<li><code>reactive</code> ä¼šæŠŠä¼ è¿›æ¥çš„å‚æ•°åŒ…è£…ä¸ºä¸€ä¸ª <code>porxy</code> å¯¹è±¡å¹¶è¿”å›</li>
<li>ä¾‹å­ä¸­ <strong>test</strong> æœ¬è´¨æ˜¯ä¸€ä¸ª<code>porxy</code>å¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡ä¹Ÿå¼•ç”¨äº† <code>obj</code>
<ul>
<li>é‚£ä¹ˆè¯·æ³¨æ„ï¼š
<ul>
<li>ç›´æ¥ä¿®æ”¹<code>obj</code>æˆ–å¼•ç”¨çš„ <code>test</code> éƒ½ä¼šå¼•èµ·å†…å­˜ä¸­æ•°æ®å˜åŒ–</li>
<li>ä½†æ˜¯ä¿®æ”¹ <code>obj</code>å› ä¸ºæ²¡æœ‰ <code>proxy</code>ç›‘å¬ï¼Œæ‰€ä»¥è§†å›¾ä¸ä¼šæ›´æ–°</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>è¯´äº†é‚£ä¹ˆå¤šï¼Œå†ç»•å›æ¥è¯´<code>toRaw</code>
<ul>
<li>ä½œç”¨ï¼šè¿”å›ç”± <code>reactive</code>  æˆ–<code> readonly</code> ç­‰æ–¹æ³•è½¬æ¢æˆå“åº”å¼ä»£ç†çš„æ™®é€šå¯¹è±¡</li>
<li>ç‰¹ç‚¹ï¼š<code>toRaw</code> æ‹¿åˆ°çš„æ•°æ®ä¸ä¼šè¢«ç›‘å¬å˜åŒ–ï¼ŒèŠ‚çœæ€§èƒ½</li>
<li>åœºæ™¯ï¼šæ•°æ®æ›´æ”¹ä¸éœ€æ›´æ–°è§†å›¾ï¼Œä¸ºæé«˜æ€§èƒ½ï¼Œé€šè¿‡ <code>toRaw</code> æ‹¿åˆ°æ•°æ®ä¿®æ”¹</li>
<li>æç¤ºï¼šå› ä¸ºæ˜¯åŸå§‹æ•°æ®ï¼Œé£é™©è¾ƒå¤§ï¼Œä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨ã€</li>
<li>æ³¨æ„ï¼šè‹¥æƒ³æ‹¿åˆ°çš„æ˜¯<code>Ref</code> åˆ›å»ºçš„å¯¹è±¡ï¼Œè®°å¾—åŠ  <strong>value</strong></li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>      <span class="hljs-keyword">let</span> obj={
        <span class="hljs-attr">name</span>:<span class="hljs-string">'èŠ±èŠ±'</span>,
        <span class="hljs-attr">age</span>:<span class="hljs-string">'3'</span>
      }
      <span class="hljs-keyword">let</span> testReactive=reactive(obj);
      <span class="hljs-keyword">let</span> testRef=ref(obj);
      <span class="hljs-keyword">let</span> rawReac=toRaw(testReactive);
      <span class="hljs-keyword">let</span> rawRef=toRaw(testRef.value);
      <span class="hljs-built_in">console</span>.log(rawReac===obj); <span class="hljs-comment">//true</span>
      <span class="hljs-built_in">console</span>.log(rawRef===obj); <span class="hljs-comment">//true</span>
</div></code></pre>
<h4 id="markraw"><strong>markRaw</strong></h4>
<ul>
<li>åœ¨ä¹‹å‰çš„çŸ¥è¯†ä½“ç³»ä¸­æˆ‘ä»¬çŸ¥é“</li>
<li>ä½œç”¨ï¼šå›ºå®šæŸæ•°æ®ï¼Œä¸è¿½è¸ªå®ƒå€¼çš„å˜åŒ–,åŒæ—¶è§†å›¾ä¹Ÿä¸ä¼šæ›´æ–°</li>
<li>é€šè¿‡æ§åˆ¶å°æŸ¥çœ‹ï¼Œä½¿ç”¨<code>markRaw</code>çš„å¯¹è±¡å‚æ•°ï¼Œè¢«èµ‹äºˆ<code>v_skip</code>ç›‘å¬è·³è¿‡æ ‡è¯†ç¬¦</li>
</ul>
<pre class="hljs"><code><div>   <span class="hljs-keyword">let</span> obj={
       <span class="hljs-attr">name</span>:<span class="hljs-string">'poo'</span>,
       <span class="hljs-attr">age</span>:<span class="hljs-string">'3'</span>
   }
   <span class="hljs-built_in">console</span>.log(obj);<span class="hljs-comment">//{name: "poo", age: "3"}</span>
    obj=markRaw(obj)<span class="hljs-comment">//ä½¿å…¶å€¼çš„æ”¹å˜ï¼Œä¸ä¼šè¢«ç›‘å¬ï¼Œè§†å›¾ä¸ä¼šå‘ç”Ÿå˜åŒ–</span>

   <span class="hljs-keyword">let</span> testReactive=reactive(obj);
   <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFun</span>(<span class="hljs-params"></span>) </span>{
     testReactive.name=<span class="hljs-string">'åœ°ç“œ'</span>;
     <span class="hljs-built_in">console</span>.log(obj);<span class="hljs-comment">//{name: "åœ°ç“œ", age: "3", __v_skip: true}</span>
   }
</div></code></pre>
<h4 id="toref"><strong>toRef</strong></h4>
<ul>
<li><code>toRef</code>å’Œ<code>ref</code>ä¸€æ ·ï¼ŒåŒæ ·ä¹Ÿæ˜¯åˆ›å»ºå“åº”å¼æ•°æ®çš„</li>
<li>å…ˆè¯´ç»“è®ºï¼š
<ul>
<li>1.<code>ref</code> å°†å¯¹è±¡ä¸­æŸå±æ€§å˜ä¸ºå“åº”å¼ï¼Œä¿®æ”¹æ—¶åŸæ•°æ®ä¸å—å½±å“</li>
<li>2.<code>toRef</code> ä¼šæ”¹å˜åŸæ•°æ®</li>
<li>3.å¹¶ä¸” <code>toRef</code> åˆ›å»ºçš„æ•°æ®ï¼Œæ”¹å˜æ—¶ç•Œé¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°</li>
</ul>
</li>
<li>åº”ç”¨åœºæ™¯ï¼šæ€§èƒ½ä¼˜åŒ–
<ul>
<li>æƒ³ä½¿åˆ›å»ºçš„å“åº”å¼æ•°æ®ä¸å…ƒæ•°æ®å…³è”èµ·æ¥</li>
<li>æ›´æ–°å“åº”å¼æ•°æ®åï¼Œä¸æƒ³æ›´æ–°UI</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>  setup() {
      <span class="hljs-comment">/** * toRef */</span>
      <span class="hljs-keyword">let</span> obj={ <span class="hljs-attr">name</span>:<span class="hljs-string">'poo'</span> }
      <span class="hljs-keyword">let</span> obj2={<span class="hljs-attr">name</span>:<span class="hljs-string">'boo'</span>}
      <span class="hljs-comment">//-æ³¨æ„ï¼šè¿™é‡Œæ˜¯è®© toRef çŸ¥é“æ˜¯è®© objé‡Œçš„ nameå˜æˆå“åº”å¼</span>
    <span class="hljs-keyword">let</span> test_toRef=toRef(obj,<span class="hljs-string">'name'</span>);
    <span class="hljs-keyword">let</span> test_ref=ref(obj2.name);
    <span class="hljs-built_in">console</span>.log(test_toRef);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFun</span>(<span class="hljs-params"></span>) </span>{
      test_toRef.value=<span class="hljs-string">'åœŸè±†'</span>;
      test_ref.value=<span class="hljs-string">'åœ°ç“œ'</span>;
      <span class="hljs-built_in">console</span>.log(obj,);<span class="hljs-comment">// {name: "åœŸè±†"}</span>
      <span class="hljs-built_in">console</span>.log(obj2);<span class="hljs-comment">// {name: "boo"}</span>
    }
    <span class="hljs-keyword">return</span> {obj,obj2, myFun };
  }
</div></code></pre>
<h4 id="torefs"><strong>toRefs</strong></h4>
<ul>
<li><code>toRef</code>åªèƒ½æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå½“ä¼ é€’æŸå¯¹è±¡å¤šä¸ªå±æ€§å€¼æ—¶ä¼šå¾ˆéº»çƒ¦</li>
<li>ç»“è®ºï¼š
<ul>
<li>1.<code>toRefs</code> æ˜¯é¿å… <code>toRef</code> å¯¹å¤šä¸ªå±æ€§æ“ä½œç¹ç</li>
<li>2.<code>toRefs</code> åº•å±‚åŸç†æ˜¯ä½¿ç”¨ <code>toRef</code> æ–¹æ³•éå†å¯¹è±¡å±æ€§å€¼</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>  setup() {
      <span class="hljs-keyword">let</span> obj={
        <span class="hljs-attr">name</span>:<span class="hljs-string">'poo'</span>,
        <span class="hljs-attr">age</span>:<span class="hljs-string">'3'</span>
      }
    <span class="hljs-keyword">let</span> test_toRefs=toRefs(obj);
    <span class="hljs-comment">/**
     * åœ¨ toRefs åº•å±‚ä¸­å…¶å®æ‰§è¡Œäº†ä»¥ä¸‹éå†æ–¹æ³•
     * let par1=toRef(obj,'name')
     * let par2=toRef(obj,'age')
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFun</span>(<span class="hljs-params"></span>) </span>{
      test_toRefs.name.value=<span class="hljs-string">'HAHA'</span>;
      test_toRefs.age.value=<span class="hljs-string">'13'</span>;
    }
    <span class="hljs-keyword">return</span> {test_toRefs, myFun };
  }
</div></code></pre>
<h4 id="%E5%9C%A8-vue30-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87-ref-%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0"><strong>åœ¨ Vue3.0 ä¸­å¦‚ä½•é€šè¿‡ ref è·å–å…ƒç´  ï¼Ÿ</strong></h4>
<ul>
<li>åœ¨ Vue2.0ç‰ˆæœ¬å†…ï¼Œé€šå¸¸ä½¿ç”¨ <code>this.$refs.XX</code> è·å–å…ƒç´ </li>
<li>åœ¨Vue3.0ä¸­ï¼ŒåºŸé™¤äº†ç±»ä¼¼<code>$</code>çš„å¾ˆå¤šç¬¦å·ï¼Œå¦‚ä½•è·å–æŒ‡å®šå…ƒç´  ï¼Ÿ</li>
<li>æ ¹æ®Vueç”Ÿå‘½å‘¨æœŸå›¾ä¸­å¯çŸ¥ï¼Œè¦æ“ä½œDOMï¼Œæœ€æ—©ä¹Ÿè¦åœ¨<code>mounted</code>ä¸­</li>
<li>ç»“è®ºï¼š
<ul>
<li>1.<code>setup</code> æ˜¯åœ¨<code>beforeCreate</code>ä¹‹å‰æ‰§è¡Œ</li>
<li>2.åœ¨ç”Ÿå‘½å‘¨æœŸä¸­ <code>onMounted</code>æœ€å…ˆå‡†å¤‡å¥½ <code>DOM</code>å…ƒç´ </li>
<li>3.<code>setup</code>ä¸­æƒ³æ“çºµ <code>DOM</code> å°±åœ¨å‡½æ•°ä¸­å¼•ç”¨ <code>onMounted</code></li>
<li>4.<code>Vue3.0</code>ä¸­ç”Ÿå‘½å‘¨æœŸå‡½æ•°è¢«æŠ½ç¦»ï¼Œå¯æ ¹æ®éœ€è¦å¼•å…¥ç›¸åº”å‘¨æœŸå‡½æ•°</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>  setup() {
    <span class="hljs-keyword">let</span> btn=ref(<span class="hljs-literal">null</span>);
    <span class="hljs-built_in">console</span>.log(btn.value);
    <span class="hljs-comment">// å›è°ƒå‡½æ•°å’Œå®ƒåœ¨å‡½æ•°ä¸­é¡ºåºæ— å…³ï¼Œæ ¹æ® Vue ç”Ÿå‘½å‘¨æœŸé¡ºåºæ‰§è¡Œ</span>
    onMounted(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{
      <span class="hljs-built_in">console</span>.log(btn.value);<span class="hljs-comment">//-  &lt;button&gt;clickMe&lt;/button&gt;  </span>
    })
    <span class="hljs-keyword">return</span> {btn};
  },
</div></code></pre>
<h4 id="readonly"><strong>readonly</strong></h4>
<ul>
<li>Vue3.0ä¸­æä¾›çš„è¿™ä¸ªAPIï¼Œä½¿å¾—æ•°æ®è¢«ä¿æŠ¤ï¼Œåªè¯»ä¸å¯ä¿®æ”¹</li>
<li>é»˜è®¤æ‰€æœ‰å±‚æ•°æ®éƒ½åªè¯»ï¼Œè‹¥åªé™åˆ¶ç¬¬ä¸€å±‚åªè¯»ï¼Œå¯ä½¿ç”¨<code>shallowReadonly</code></li>
<li><code>isReadonly</code>ç”¨æ¥æ£€æµ‹æ•°æ®åˆ›å»ºæ¥æºæ˜¯å¦æ˜¯ <code>readonly</code></li>
<li>è‹¥è¿›è¡Œä¿®æ”¹ï¼Œæµè§ˆå™¨ä¼šæç¤ºæ“ä½œå¤±è´¥ï¼Œç›®æ ‡åªè¯»</li>
</ul>
<pre class="hljs"><code><div>  setup() {
    <span class="hljs-keyword">let</span> obj={
      <span class="hljs-attr">name</span>:<span class="hljs-string">'poo'</span>,
      <span class="hljs-attr">age</span>:<span class="hljs-string">'13'</span>
    }
    <span class="hljs-keyword">let</span> only=readonly(obj)
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFun</span>(<span class="hljs-params"></span>) </span>{
      only.name=<span class="hljs-string">'HAHA'</span>;<span class="hljs-comment">//  failed: target is readonly</span>
    }
    <span class="hljs-keyword">return</span> {only, myFun };
  }
</div></code></pre>
<h4 id="vue30%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%9C%AC%E8%B4%A8">** Vue3.0å“åº”å¼æ•°æ®æœ¬è´¨**</h4>
<ul>
<li>2.0ä¸­ä½¿ç”¨çš„ <code>Object.defineProperty</code> å®ç°å“åº”å¼æ•°æ®</li>
<li>3.0ä¸­ä½¿ç”¨çš„ <code>Proxy</code> æ¥å®ç°,å¦‚ä¸‹</li>
</ul>
<pre class="hljs"><code><div>    <span class="hljs-keyword">let</span> obj={
      <span class="hljs-attr">name</span>:<span class="hljs-string">'poo'</span>,
      <span class="hljs-attr">age</span>:<span class="hljs-string">'13'</span>
    }
    <span class="hljs-keyword">let</span> objProxy=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj,{
      <span class="hljs-comment">//æ•°æ®è¯»ä¼šè§¦å‘</span>
      <span class="hljs-keyword">get</span>(obj,key){
        <span class="hljs-built_in">console</span>.log(obj);<span class="hljs-comment">//{name: "poo", age: "13"}</span>
        <span class="hljs-keyword">return</span> obj[key]
      },
      <span class="hljs-comment">//ç›‘å¬çš„æ•°æ®è¢«ä¿®æ”¹ä¼šè§¦å‘</span>
      <span class="hljs-keyword">set</span>(obj,key,value){
      <span class="hljs-comment">// æ“ä½œçš„å¯¹è±¡ï¼Œæ“ä½œçš„å±æ€§ï¼Œèµ‹äºˆçš„æ–°å€¼</span>
      obj[key]=value <span class="hljs-comment">//æŠŠå¤–ç•Œèµ‹äºˆçš„æ–°å€¼æ›´æ–°åˆ°è¯¥å¯¹è±¡</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'è¿›è¡ŒUIä¹‹ç±»çš„æ“ä½œ'</span>);
      <span class="hljs-comment">//-è¡¥å……ï¼Œæœ‰æ—¶ä¼šå¤šæ¬¡æ“ä½œï¼Œæ­¤æ—¶å¿…é¡»return trueæ‰ä¸ä¼šå½±å“ä¸‹æ¬¡æ“ä½œ</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    })
   objProxy.name;
</div></code></pre>
<h4 id="%E5%AE%9E%E7%8E%B0shallowreactive%E5%92%8Cshallowref"><strong>å®ç°shallowReactiveå’ŒshallowRef</strong></h4>
<ul>
<li>å®ƒä»¬äºŒè€…ä¹Ÿæ˜¯é€šè¿‡å‚æ•°ä¼ é€’ï¼ŒåŒ…è£…æˆ <code>proxy</code> å¯¹è±¡è¿›è¡Œç›‘å¬</li>
<li>åœ¨ <code>Proxy</code> çš„ <code>set</code> ç›‘å¬ä¸­ï¼ŒåŒæ ·åªç›‘å¬ç¬¬ä¸€å±‚</li>
<li><code>shallowRef</code> åªæ˜¯åœ¨ <code>shallowReactive</code> åŸºç¡€ä¸Šé»˜è®¤æ·»åŠ  <code>value</code> é”®å</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shallowReactive</span>(<span class="hljs-params">obj</span>)</span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj,{
    <span class="hljs-keyword">get</span>(obj,key){
      <span class="hljs-keyword">return</span> obj[key]
    },
    <span class="hljs-keyword">set</span>(obj,key,value){
      obj[key]=value
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ›´æ–°'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  })
}
<span class="hljs-keyword">let</span> obj={
  <span class="hljs-attr">A</span>:<span class="hljs-string">'A'</span>,
  <span class="hljs-attr">B</span>:{
    <span class="hljs-attr">b1</span>:<span class="hljs-string">'b1'</span>,
    <span class="hljs-attr">b2</span>:<span class="hljs-string">'b2'</span>,
    <span class="hljs-attr">b3</span>:{
      <span class="hljs-attr">b3_1</span>:<span class="hljs-string">'b3-1'</span>,
      <span class="hljs-attr">b3_2</span>:<span class="hljs-string">'b3-2'</span>
    } } }
<span class="hljs-keyword">let</span> test=shallowReactive(obj)
<span class="hljs-comment">//-è¿™é‡ŒåŒæ ·åªä¼šç›‘å¬ç¬¬ä¸€å±‚</span>
test.A=<span class="hljs-string">'apple'</span>;
test.B.b2=<span class="hljs-string">'banana'</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shallowRef</span>(<span class="hljs-params">obj</span>)</span>{
  <span class="hljs-keyword">return</span> shallowReactive(obj,{<span class="hljs-attr">value</span>:vl})
}
<span class="hljs-keyword">let</span> state=shallowRef(obj);
</div></code></pre>
<h4 id="%E5%AE%9E%E7%8E%B0-reactive-%E5%92%8C-ref"><strong>å®ç° reactive å’Œ ref</strong></h4>
<ul>
<li>å®ƒä»¬ä¸ä¸Šæ–¹åŒºåˆ«åœ¨äºé€’å½’ç›‘å¬</li>
<li>ä¸Šæ–¹å› ä¸ºç›´æ¥ä¼ é€’å‚æ•°å¯¹è±¡ï¼Œæ‰€ä»¥åªç›‘å¬ç¬¬ä¸€å±‚</li>
<li>ä¸ºäº†é€’å½’ç›‘å¬ï¼Œé‚£ä¹ˆè¦æŠŠæ•°æ®çš„æ¯ä¸€å±‚éƒ½ç»™åŒ…è£…æˆ <code>Proxy</code>å¯¹è±¡</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactive</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">"object"</span>) {
    <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) {
      <span class="hljs-comment">//å½“å‰å‚æ•°ä¸ºæ•°ç»„ç±»å‹ï¼Œåˆ™å¾ªç¯å–å‡ºæ¯ä¸€é¡¹</span>
      obj.forEach(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item === <span class="hljs-string">"object"</span>) {
          <span class="hljs-comment">//åˆ†ææ•°ç»„æ¯ä¸€é¡¹ï¼Œæ˜¯å¯¹è±¡åˆ™é€’å½’</span>
          obj[index] = reactive(item);
        }
      });
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å½“å‰å‚æ•°æ˜¯å¯¹è±¡ä¸”ä¸æ˜¯æ•°ç»„ï¼Œåˆ™å–å±æ€§å€¼å¹¶è¿›è¡Œåˆ†ææ˜¯å¦æ˜¯å¤šå±‚å¯¹è±¡</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[key] === <span class="hljs-string">"object"</span>) {
          obj[key] = reactive(item);
        }
      }
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"å½“å‰ä¼ å…¥ä¸ºéå¯¹è±¡å‚æ•°"</span>);
  }
  <span class="hljs-comment">//-æ­£å¸¸æƒ…å†µä¸‹å°±è¿›è¡Œ Proxyå¯¹è±¡åŒ…è£…</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, {
    <span class="hljs-keyword">get</span>(obj, key) {
      <span class="hljs-keyword">return</span> obj[key];
    },
    <span class="hljs-keyword">set</span>(obj, key, value) {
      obj[key] = value;
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"æ›´æ–°"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
  });
}
</div></code></pre>
<h4 id="%E5%AE%9E%E7%8E%B0-shallowreadonly-%E5%92%8C-readonly"><strong>å®ç° shallowReadonly å’Œ readonly</strong></h4>
<ul>
<li>äºŒè€…åŒºåˆ«åªåœ¨äºé¦–å±‚ç›‘å¬ï¼Œåªè¯»æ‹’ç»ä¿®æ”¹å’Œæ•°æ®å…¨å±‚ä¿®æ”¹</li>
<li>ä¸‹æ–¹å®ç°çš„æ˜¯ <code>shallowReadonly</code></li>
<li><code>readonly</code> å®ç°æ˜¯åœ¨ <code>shallowReadonly</code> åŸºç¡€ä¸Šç§»é™¤<code>set</code> ä¸­çš„<code>return true</code></li>
</ul>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shallowReadonly</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, {
    <span class="hljs-keyword">get</span>(obj, key) {
      <span class="hljs-keyword">return</span> obj[key];
    },
    <span class="hljs-keyword">set</span>(obj, key, value) {
      <span class="hljs-comment">// obj[key] = value;</span>
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`<span class="hljs-subst">${key}</span>ä¸ºåªè¯»ï¼Œä¸å¯ä¿®æ”¹-`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//æ­¤è¡Œç§»é™¤ï¼Œåˆ™å°±æ˜¯ readonly å…¨å±‚æ•°æ®åªè¯»</span>
    },
  });
}
<span class="hljs-keyword">let</span> parse = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">"fruit"</span>,
  <span class="hljs-attr">suchAS</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"cucumber"</span>,
  },
};
<span class="hljs-keyword">let</span> fakeShowRe=shallowReadonly(parse);
fakeShowRe.type=<span class="hljs-string">'HAHA'</span>;<span class="hljs-comment">// æ­¤æ—¶ä¿®æ”¹ä¸ä¼šç”Ÿæ•ˆ</span>
fakeShowRe.suchAS.name=<span class="hljs-string">'HAHA'</span>;<span class="hljs-comment">// éé¦–å±‚ä¿®æ”¹ä¼šç”Ÿæ•ˆ</span>
</div></code></pre>

</body>
</html>
